<ion-header>
  <ion-toolbar>
    <ion-title>AI Chat</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list>
    <ion-item *ngFor="let m of messages; let i = index" lines="none">
      <ion-label>
        <b>{{ m.role === 'user' ? 'Tú' : 'IA' }}</b>
        <div style="white-space: pre-wrap">{{ m.content }}</div>
      </ion-label>
    </ion-item>
    <ion-item *ngIf="loading" lines="none">
      <ion-label>
        <ion-spinner name="dots"></ion-spinner>
        &nbsp;escribiendo…
      </ion-label>
    </ion-item>
  </ion-list>
</ion-content>

<ion-footer>
  <ion-item>
    <ion-input
      [(ngModel)]="text"
      placeholder="Escribe tu mensaje…"
      (keyup.enter)="send()">
    </ion-input>
    <ion-button slot="end" (click)="send()" [disabled]="loading || !text?.trim()">Enviar</ion-button>
    <ion-button slot="end" fill="outline" color="medium" (click)="stop()" [disabled]="!loading">Detener</ion-button>
    <ion-button slot="end" fill="clear" color="danger" (click)="reset()">Reset</ion-button>
  </ion-item>
</ion-footer>
