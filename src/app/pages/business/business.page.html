<ion-content [fullscreen]="true">
  <div class="business">
    <!-- Header -->
    <div class="header">
      <div class="header-content">
        <div class="header-text">
          <h1 class="title">Mi Negocio</h1>
          <p class="subtitle">Gestiona la información de tu negocio</p>
        </div>
        <div class="header-actions">

          <ion-icon name="business" color="warning" size="large"></ion-icon>
        </div>
      </div>
    </div>

    <div class="content">
      <!-- No Business State -->
      <div *ngIf="!businessData.id && !businessData.idNegocio && !isLoading" class="no-business-state">
        <ion-card>
          <ion-card-content>
            <div class="empty-state">
              <ion-icon name="business" size="large" color="medium"></ion-icon>
              <h3>No hay negocio registrado</h3>
              <p>Parece que aún no tienes un negocio asociado a tu cuenta.</p>
              <ion-button expand="block" routerLink="/tabs/settings">
                <ion-icon slot="start" name="add"></ion-icon>
                Crear Negocio
              </ion-button>
              <ion-button expand="block" fill="outline" (click)="refreshData()">
                <ion-icon slot="start" name="refresh"></ion-icon>
                Intentar de nuevo
              </ion-button>
            </div>
          </ion-card-content>
        </ion-card>
      </div>

      <!-- Business Info Card -->
      <ion-card *ngIf="businessData.id || businessData.idNegocio" class="business-card">
        <ion-card-content>
          <div class="card-header">
            <h2 class="card-title">Información del Negocio</h2>
            <ion-button 
              *ngIf="!isEditing" 
              fill="outline" 
              size="small" 
              (click)="toggleEdit()">
              <ion-icon slot="start" name="pencil"></ion-icon>
              Editar
            </ion-button>
          </div>

          <div class="form-fields">
            <!-- Business Name -->
            <div class="field-group">
              <ion-label class="field-label">Nombre del negocio</ion-label>
              <ion-input
                [readonly]="!isEditing"
                [(ngModel)]="businessData.nombreNegocio"
                placeholder="Nombre del negocio"
                class="custom-input">
              </ion-input>
            </div>

            <!-- Business Description -->
            <div class="field-group">
              <ion-label class="field-label">Descripción del negocio</ion-label>
              <ion-input
                [readonly]="!isEditing"
                [(ngModel)]="businessData.descripcion"
                placeholder="Descripción del negocio"
                class="custom-input">
              </ion-input>
            </div>

            <!-- Sector -->
            <div class="field-group">
              <ion-label class="field-label">Sector</ion-label>
              <ion-select 
                [disabled]="!isEditing"
                [(ngModel)]="businessData.sector"
                placeholder="Selecciona sector"
                interface="popover"
                class="custom-select">
                <ion-select-option 
                  *ngFor="let sector of sectors" 
                  [value]="sector.value">
                  {{sector.label}}
                </ion-select-option>
              </ion-select>
            </div>

            <!-- Capital Inicial -->
            <div class="field-group">
              <ion-label class="field-label">Capital inicial (USD)</ion-label>
              <ion-input
                [readonly]="!isEditing"
                [(ngModel)]="businessData.capitalInicial"
                type="number"
                placeholder="Capital inicial"
                class="custom-input">
              </ion-input>
            </div>

            <!-- Business Type -->
            <div class="field-group">
              <ion-label class="field-label">Tipo de negocio</ion-label>
              <ion-select 
                [disabled]="!isEditing"
                [(ngModel)]="businessData.type"
                placeholder="Selecciona tipo"
                interface="popover"
                class="custom-select">
                <ion-select-option 
                  *ngFor="let type of businessTypes" 
                  [value]="type.value">
                  {{type.label}}
                </ion-select-option>
              </ion-select>
            </div>

            <!-- Start Date -->
            <div class="field-group">
              <ion-label class="field-label">Fecha de inicio</ion-label>
              <ion-datetime
                [disabled]="!isEditing"
                [(ngModel)]="businessData.startDate"
                presentation="date"
                class="custom-datetime">
                <ion-button slot="end" fill="clear">
                  <ion-icon name="calendar-outline"></ion-icon>
                </ion-button>
              </ion-datetime>
            </div>

            <!-- Action Buttons - Edit Mode -->
            <div *ngIf="isEditing" class="action-buttons">
              <ion-button expand="block" color="warning" (click)="handleSave()">
                <ion-icon slot="start" name="save"></ion-icon>
                Guardar Cambios
              </ion-button>
              <ion-button expand="block" fill="outline" (click)="handleCancel()">
                Cancelar
              </ion-button>
            </div>

            <!-- Delete Button - View Mode -->
            <div *ngIf="!isEditing" class="action-buttons">
              <ion-button expand="block" color="danger" (click)="handleDelete()">
                <ion-icon slot="start" name="trash"></ion-icon>
                Eliminar Negocio
              </ion-button>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Business Stats -->
      <div *ngIf="businessData.id || businessData.idNegocio" class="stats-row">
        <ion-card class="stat-card">
          <ion-card-content>
            <div class="stat-value">${{ businessData.capitalInicial || 0 | number }}</div>
            <div class="stat-label">Capital inicial</div>
          </ion-card-content>
        </ion-card>

        <ion-card class="stat-card">
          <ion-card-content>
            <div class="stat-value">{{ businessData.sector || 'N/A' }}</div>
            <div class="stat-label">Sector</div>
          </ion-card-content>
        </ion-card>
      </div>
    </div>
  </div>
</ion-content>
