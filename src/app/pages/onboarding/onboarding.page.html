<ion-content [fullscreen]="true" class="onboarding-container">
  <div class="onboarding-content">
    <!-- Step Content -->
    <div class="step-content">
      
      <!-- Step 0: Name and Birthday -->
      <ion-card *ngIf="currentStep === 0" class="onboarding-card">
        <ion-card-content>
          <div class="card-header">
            <h2>¡Bienvenido! Cuéntanos sobre ti</h2>
          </div>
          
          <div class="form-fields">
            <!-- Name Field -->
            <div class="field-group">
              <ion-input
                [(ngModel)]="userData.name"
                label="Nombre completo"
                labelPlacement="floating"
                placeholder="Ingresa tu nombre completo"
                [class.invalid]="nameError"
                (ionInput)="clearNameError()">
              </ion-input>
              <div *ngIf="nameError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ nameError }}
              </div>
            </div>

            <!-- Birthday Field -->
            <div class="field-group">
              <div class="date-input-wrapper" [class.invalid]="birthdayError">
                <label class="date-label">Cumpleaños</label>
                <input 
                  type="date"
                  class="native-date-input"
                  [value]="getDateInputValue()"
                  [max]="getMaxDateString()"
                  [min]="getMinDateString()"
                  (change)="onNativeDateChange($event)"
                  (focus)="clearBirthdayError()"
                  placeholder="Selecciona tu fecha de nacimiento">
                <ion-icon name="calendar-outline" class="date-icon"></ion-icon>
              </div>
              
              <div *ngIf="birthdayError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ birthdayError }}
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Step 1: Phone -->
      <ion-card *ngIf="currentStep === 1" class="onboarding-card">
        <ion-card-content>
          <div class="card-header">
            <h2>¿Cuál es tu número de celular?</h2>
          </div>
          
          <div class="form-fields">
            <div class="field-group">
              <ion-input
                [(ngModel)]="userData.phone"
                type="tel"
                label="Número de teléfono"
                labelPlacement="floating"
                placeholder="Ingresa tu número de teléfono"
                [class.invalid]="phoneError"
                (ionInput)="clearPhoneError()">
              </ion-input>
              <div *ngIf="phoneError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ phoneError }}
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Step 2: Business Data -->
      <ion-card *ngIf="currentStep === 2" class="onboarding-card">
        <ion-card-content>
          <div class="card-header">
            <h2>Cuéntanos sobre tu negocio</h2>
          </div>
          
          <div class="form-fields">
            <!-- Business Name Field -->
            <div class="field-group">
              <ion-input
                [(ngModel)]="businessData.nombreNegocio"
                label="Nombre del negocio"
                labelPlacement="floating"
                placeholder="Ingresa el nombre de tu negocio"
                [class.invalid]="businessNameError"
                (ionInput)="clearBusinessNameError()">
              </ion-input>
              <div *ngIf="businessNameError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ businessNameError }}
              </div>
            </div>

            <!-- Business Description Field -->
            <div class="field-group">
              <ion-input
                [(ngModel)]="businessData.descripcion"
                label="Descripción del negocio"
                labelPlacement="floating"
                placeholder="Describe brevemente tu negocio"
                [class.invalid]="businessDescriptionError"
                (ionInput)="clearBusinessDescriptionError()">
              </ion-input>
              <div *ngIf="businessDescriptionError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ businessDescriptionError }}
              </div>
            </div>

            <!-- Business Sector Field -->
            <div class="field-group">
              <ion-select
                [(ngModel)]="businessData.sector"
                label="Sector del negocio"
                labelPlacement="floating"
                placeholder="Selecciona el sector"
                [class.invalid]="businessSectorError"
                (ionChange)="clearBusinessSectorError()">
                <ion-select-option *ngFor="let sector of businessSectors" [value]="sector">
                  {{ sector }}
                </ion-select-option>
              </ion-select>
              <div *ngIf="businessSectorError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ businessSectorError }}
              </div>
            </div>

            <!-- Capital Initial Field -->
            <div class="field-group">
              <ion-input
                [(ngModel)]="businessData.capitalInicial"
                type="number"
                label="Capital inicial (USD)"
                labelPlacement="floating"
                placeholder="Ingresa el capital inicial"
                [class.invalid]="businessCapitalError"
                (ionInput)="clearBusinessCapitalError()">
              </ion-input>
              <div *ngIf="businessCapitalError" class="error-message">
                <ion-icon name="alert-circle"></ion-icon>
                {{ businessCapitalError }}
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Steps 3-5: Feature Introduction Cards -->
      <ion-card *ngIf="currentStep >= 3 && currentStep <= 5" class="onboarding-card feature-card">
        <ion-card-content>
          <div class="feature-content">
            <!-- Feature Icon -->
            <div class="feature-icon" [style.background-color]="getCurrentFeature()?.color">
              <ion-icon [name]="getCurrentFeature()?.icon"></ion-icon>
            </div>

            <!-- Feature Title -->
            <h2>{{ getCurrentFeature()?.title }}</h2>

            <!-- Feature Description -->
            <p>{{ getCurrentFeature()?.description }}</p>

            <!-- Step Indicators -->
            <div class="step-indicators">
              <div 
                *ngFor="let feature of onboardingFeatures; let i = index"
                class="indicator"
                [class.active]="i === currentStep - 3">
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

    </div>

    <!-- Navigation Buttons -->
    <div class="navigation-buttons">
      <ion-button 
        fill="clear" 
        (click)="prevStep()"
        [disabled]="currentStep === 0">
        <ion-icon name="chevron-back" slot="start"></ion-icon>
        Anterior
      </ion-button>

      <ion-button 
        (click)="nextStep()"
        [disabled]="isNextDisabled()">
        <span *ngIf="currentStep < 5">Siguiente</span>
        <span *ngIf="currentStep === 5">Comenzar</span>
        <ion-icon 
          *ngIf="currentStep < 5" 
          name="chevron-forward" 
          slot="end">
        </ion-icon>
        <ion-icon 
          *ngIf="currentStep === 5" 
          name="checkmark" 
          slot="end">
        </ion-icon>
      </ion-button>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-container">
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          [style.width.%]="getProgressPercentage()">
        </div>
      </div>
      <span class="progress-text">{{ currentStep + 1 }} de {{ totalSteps }}</span>
    </div>
  </div>

</ion-content>
